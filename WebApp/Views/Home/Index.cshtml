<div class="container">
    <div class="row">
        <div class="col-md-6">
            <span>Name: </span>
            <input type="text" id="txtUser" /> <br />
            <span>Message: </span>
            <textarea rows="10" cols="50" id="txtMsg"></textarea>
            <button type="submit" class="btn btn-info" id="btnSend">Send</button>
        </div>
        <div class="col-md-6">
            <h3>Messages:</h3>
            <ul id="list" class="alert alert-info"></ul>
        </div>
    </div>
</div>

<script src="~/lib/jquery/dist/jquery.js"></script>
<script src="~/lib/signalr/signalr/dist/browser/signalr.js"></script>

<script>
    var connection = new signalR.HubConnectionBuilder().withUrl("/chatHub").build();

    // Bắt sự kiện khi nhận tin nhắn
    connection.on("ReceiveMessage", function (fromUser, message) {
        var msg = fromUser + " : " + message;
        var li = document.createElement("li");
        li.textContent = msg;
        document.getElementById("list").appendChild(li);
    });

    connection.start().then(function () {
        // Xử lý sự kiện khi nhấn nút "Send"
        $("#btnSend").on("click", function () {
            var fromUser = $("#txtUser").val();
            var message = $("#txtMsg").val();

            // Gửi tin nhắn lên máy chủ SignalR
            connection.invoke("SendMessage", fromUser, message);
        });
    }).catch(function (err) {
        return console.error(err.toString());
    });
</script>
